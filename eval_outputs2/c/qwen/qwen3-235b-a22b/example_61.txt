<think>
No reasoning found</think>
```c
  pktin = sftp_wait_for_reply(req);
  dirh = fxp_opendir_recv(pktin, req);

  if (dirh == NULL) {
    printf("Unable to open %s: %s\n", dir, fxp_error());
    return 0;
  } else {
    nnames = namesize = 0;
    ournames = NULL;

    while (1) {
```