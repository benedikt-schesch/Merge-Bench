<think>
No reasoning found</think>
```c
  ret->refcount = 1;
  *realhost = '\0';

  if ((a = p_inet_addr(host)) == (unsigned long)INADDR_NONE) {
    struct hostent *h = NULL;
    int err = 0;
#ifndef NO_IPV6
    /*
     * Use getaddrinfo when it's available
     */
    if (p_getaddrinfo) {
```