<think>
No reasoning found</think>
```c
    if (bufsize_after < bufsize_before)
      plug_sent(s->plug, bufsize_after);
  } break;
  case FD_CLOSE:
    /* Signal a close on the socket. First read any outstanding data. */
<<<<<<< HEAD
    open = 1;
=======
>>>>>>> 4348393f562c8011ebca43d6198e98638aa115b5
    do {
      ret = p_recv(s->s, buf, sizeof(buf), 0);
      if (ret < 0) {
        err = p_WSAGetLastError();
        if (err == WSAEWOULDBLOCK)
```