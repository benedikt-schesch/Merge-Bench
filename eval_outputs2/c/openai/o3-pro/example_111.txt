<think>
No reasoning found</think>
```c

  if (error_msg)
    logevent(error_msg);
  if (!ssh->close_expected || !ssh->clean_exit)
    connection_fatal(ssh->frontend, "%s", error_msg);
  return 0;
}

static void ssh_receive(Plug plug, int urgent, char *data, int len)
{
  Ssh ssh = (Ssh)plug;

```