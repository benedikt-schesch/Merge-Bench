<think>
No reasoning found</think>
```c
  struct ssh_sharing_state *sharestate = (struct ssh_sharing_state *)plug;
  if (error_msg)
    ssh_sharing_logf(sharestate->ssh, 0, "listening socket: %s", error_msg);
  sk_close(sharestate->listensock);
  sharestate->listensock = NULL;
  return 1;
}

static void share_send_verstring(struct ssh_sharing_connstate *cs)
{
  char *fullstring = dupcat("SSHCONNECTION@putty.projects.tartarus.org-2.0-",
```