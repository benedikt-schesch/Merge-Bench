<think>
No reasoning found</think>
```java
                if (leaf is T ancestor)
                {
                    return ancestor;
                }

                leaf = leaf is Visual || leaf is Visual3D
                    ? VisualTreeHelper.GetParent(leaf)
                    : LogicalTreeHelper.GetParent(leaf);
            }

            return default(T);

```