<think>
No reasoning found</think>
```java
            //    return value.GenerateId(collectionName);

            lock (generatorLock)
            {
                if (keyGeneratorsByTag.TryGetValue(collectionName, out value))
                    return value.GenerateId(collectionName);

                value = new HiLoIdGenerator(db, _capacity);
                // doing it this way for thread safety
                keyGeneratorsByTag = new Dictionary<string, HiLoIdGenerator>(keyGeneratorsByTag)
                {
                    {collectionName, value}
                };
```