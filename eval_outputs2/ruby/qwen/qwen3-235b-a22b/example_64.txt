<think>
No reasoning found</think>
```ruby

		retries = 0
		time_in_db = 0
		begin
			t1 = Time.now
			time_in_db = yield chunksize
			time_in_db = time_in_db.to_f rescue 0
		rescue Errno::EPIPE, RestClient::RequestFailed
			retries += 1
			raise if retries > 2

			# we got disconnected, the chunksize could be too large

```