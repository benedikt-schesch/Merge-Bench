<think>
No reasoning found</think>
```ruby
    end
    # the Rails reloader is responsible for reseting Current after every unit of work
  end

  it "persists" do
    Sidekiq::CurrentAttributes.persist("Myapp::Current", @config)
    job_hash = {}
    with_context(:user_id, 16) do
      @config.client_middleware.invoke(nil, job_hash, nil, nil) do
        assert_equal 16, job_hash["cattr"][:user_id]
      end
```