<think>
No reasoning found</think>
```ruby
          SET `locked_at`=#{quote_value(now)} 
          WHERE #{self.class.primary_key} = #{quote_value(id)} AND (`locked_by`=#{quote_value(worker)})
        end_sql

      end
<<<<<<< HEAD

      unless affected_rows == 1
=======
      
      unless affected_rows == 1                                                           
>>>>>>> 3e5c37308ee51d35b9fae438da419cb40770a95b
        raise LockError, "Attempted to aquire exclusive lock failed"
      end

      self.locked_at    = now
      self.locked_by    = worker

```