<think>
No reasoning found</think>
```ruby
			retry
		end

		t2 = Time.now

<<<<<<< HEAD
		diff = t2 - t1
=======
		diff = t2 - t1 - time_in_db

>>>>>>> a4449f2eb4e6c25811b857fc1a6d6501831b7cde
		new_chunksize = if retries > 0
			chunksize
		elsif diff > 3.0
			(chunksize / 3).ceil
		elsif diff > 1.1

```