<think>
No reasoning found</think>
```ruby
      # dont run cleanup more than once per minute
      return 0 unless Sidekiq.redis { |conn| conn.set("process_cleanup", "1", nx: true, ex: 60) }

      count = 0
      Sidekiq.redis do |conn|
        procs = conn.sscan_each("processes").to_a.sort
        heartbeats = conn.pipelined { |pipeline|
          procs.each do |key|
            pipeline.hget(key, "info")
          end
        }

```