<think>
No reasoning found</think>
```python
        elif isinstance(schema, (frozenset, set)):
            return self._compile_set(schema)
        type_ = type(schema)
        if inspect.isclass(schema):
            type_ = schema
<<<<<<< HEAD
        if type_ in (*primitive_types, object, list, dict, type(None)) or callable(schema):
=======
        if type_ in (*primitive_types, object, type(None)) or callable(schema):
>>>>>>> 1fcf849f16279d43010c89c5d8cf69d5de96a800
            return _compile_scalar(schema)
        raise er.SchemaError('unsupported schema data type %r' % type(schema).__name__)

    def _compile_mapping(self, schema, invalid_msg=None):
        """Create validator for given mapping."""

```