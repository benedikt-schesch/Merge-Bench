<think>
No reasoning found</think>
```typescript

    // only effectively close connection when "onLeave" is fulfilled
    this._onLeave(client, closeCode).then(() => client.leave(closeCode));
  }

<<<<<<< HEAD
  protected async _onLeave(client: Client, code?: number): Promise<any> {
    const success = this.clients.delete(client);
=======
  private async _onLeave(client: Client, code?: number): Promise<any> {
    debugMatchMaking('onLeave, sessionId: \'%s\'', client.sessionId);
>>>>>>> 1a7da98cbeee551587e6119d06a39a441421827b

    // call 'onLeave' method only if the client has been successfully accepted.
    client.state = ClientState.LEAVING;

    if (!this.clients.delete(client)) {

```