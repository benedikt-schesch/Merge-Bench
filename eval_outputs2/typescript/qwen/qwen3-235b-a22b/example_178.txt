<think>
No reasoning found</think>
```typescript
    return res
  }

  async newCalendarClient (user: User, code: string): Promise<CalendarClient> {
    const newClient = await CalendarClient.create(user, this.mongo, this.client, this)
    const userId = await newClient.authorize(code)
    if (this.clients.has(userId)) {
      newClient.close()
      throw new Error('Client already exist')
    }
    this.clients.set(userId, newClient)
    return newClient
```