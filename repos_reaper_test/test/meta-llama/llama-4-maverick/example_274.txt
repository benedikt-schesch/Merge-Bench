<think>
No reasoning found</think>
```java
            } catch (PlanException e) {
                int errCode = 2029;
                String msg = "Error rewriting join package.";
                throw new MRCompilerException(msg, errCode, PigException.BUG, e);
            }

            mr.phyToMRMap.put(forEach, pack);
            LogFactory.getLog(LastInputStreamingOptimizer.class).info(
                    "Rewrite: POPackage->POForEach to POJoinPackage");
        }

    }

    private static class FindKeyTypeVisitor extends PhyPlanVisitor {
```