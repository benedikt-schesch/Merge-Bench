<think>
No reasoning found</think>
ĊĊ```javaĊĠĠĠĠĠĠĠĠĠĠĠĠ//ĠprettyĠquickly.ĠSinceĠit'sĠmostĠlikelyĠgoingĠtoĠfitĠinĠtheĠsameĊĠĠĠĠĠĠĠĠĠĠĠĠ//ĠpacketĠweĠsendĠout,ĠitĠaddsĠ~zeroĠoverhead.ĠButĠdon'tĠpiggybackĠaĊĠĠĠĠĠĠĠĠĠĠĠĠ//ĠversionĠrequestĠifĠtheĠpayloadĠisĠalreadyĠaĠversionĠrequestĠorĠifĊĠĠĠĠĠĠĠĠĠĠĠĠ//ĠweĠalreadyĠknowĠtheĠserverĠversion.ĊĠĠĠĠĠĠĠĠĠĠĠĠfinalĠChannelBufferĠbuf;ĊĠĠĠĠĠĠĠĠĠĠĠĠifĠ(client.server_versionĠ<Ġ0Ġ&&Ġ!isVersionRequest(payload))Ġ{ĊĠĠĠĠĠĠĠĠĠĠĠĠĠĠfinalĠChannelBufferĠversionĠ=ĊĠĠĠĠĠĠĠĠĠĠĠĠĠĠĠĠclient.encode(client.getProtocolVersionRequest());ĊĠĠĠĠĠĠĠĠĠĠĠĠĠĠbufĠ=ĠChannelBuffers.wrappedBuffer(header,Ġpayload,Ġversion);ĊĠĠĠĠĠĠĠĠĠĠĠĠ}ĠelseĠ{ĊĠĠĠĠĠĠĠĠĠĠĠĠĠĠbufĠ=ĠChannelBuffers.wrappedBuffer(header,Ġpayload);ĊĊ```