<think>
No reasoning found</think>
```java

    public <T> T unmarshall(DBObject document, Class<T> clazz) throws MarshallingException {

        DocumentStream stream = DocumentStreamFactory.fromDBObject(document);
        try {
            // Combine both intents: map document to JSON, then read value with the correct type.
            String json = stream.getData();
            // Using mapper and reader to cover both usages.
            return mapper.readValue(json, stream.getOffset(), stream.getSize(), clazz);
        } catch (Exception e) {
            String message = String.format("Unable to unmarshall result to %s from content %s", clazz, document.toString());
            throw new MarshallingException(message, e);
        }
    }

    public DBObject marshall(Object obj) throws MarshallingException {

```