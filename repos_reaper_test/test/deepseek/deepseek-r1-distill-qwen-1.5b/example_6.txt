<think>
No reasoning found</think>
```
            writeString(prefix, buf);
            writeString(suffix, buf);
            buf.writeByte(friendlyFire);
            if(protocolVersion >= ProtocolConstants.MINECRAFT_1_8) {
                if(protocolVersion >= ProtocolConstants.MINECRAFT_1_9) {
                    writeString(nameTagVisibility, buf);
                }
                buf.writeByte(color);
            }
            if(mode == 0 || mode == 3 || mode == 4) {
                if(protocolVersion >= ProtocolConstants.MINECRAFT_1_8) {
                    writeString(nameTagVisibility, buf);
                }
                buf.writeByte(color);
            }
        }
```