<think>
No reasoning found</think>
Here is the merged snippet that resolves the conflict by combining both sets of changes:

```java
  private CallbackContext initCallbackContext;
  private CallbackContext scanCallbackContext;
  private Object scanLock = new Object();
  private CallbackContext permissionsCallback;
  private CallbackContext locationCallback;

  private CallbackContext initPeripheralCallback;
  private BluetoothGattServer gattServer;
  private CallbackContext addServiceCallback;
  private CallbackContext advertiseCallbackContext;
  private boolean isAdvertising = false;

  //Store connections and all their callbacks
  private HashMap<Object, HashMap<Object,Object>> connections;

  //Discovery related variables
```