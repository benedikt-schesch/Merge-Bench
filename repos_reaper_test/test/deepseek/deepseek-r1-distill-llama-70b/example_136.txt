<think>
No reasoning found</think>
To resolve this conflict, we need to incorporate the optimization step from the right side (d95d3beb) before checking the physical plan. This ensures the logical plan is optimized prior to physical plan compilation.

```java
    }

    private PhysicalPlan checkPhysicalPlan(LogicalPlan lp, int expectedRoots,
            int expectedLeaves, int expectedSize) throws IOException {

        lp.optimize(myPig.getPigContext());
        System.out.println("===== check physical plan =====");

        PhysicalPlan pp = ((MRExecutionEngine)myPig.getPigContext().getExecutionEngine()).compile(
                lp, null);

        Assert.assertEquals(expectedRoots, pp.getRoots().size());
```