<think>
No reasoning found</think>
The conflict arises because the code in one branch compiles the logical plan before optimizing it, which is incorrect. To ensure proper order, the code should first optimize the LogicalPlan and then compile it.

```java
    }

    private PhysicalPlan checkPhysicalPlan(LogicalPlan lp, int expectedRoots,
            int expectedLeaves, int expectedSize) throws IOException {

<<<<<<< HEAD
        System.out.println("===== check physical plan =====");
=======
        lp.optimize(myPig.getPigContext());
        System.out.println("===== check physical plan =====");        
>>>>>>> d95d3beb3c320c98d0af2ce3bcd2f3b656bdc98d

        PhysicalPlan pp = ((MRExecutionEngine)myPig.getPigContext().getExecutionEngine()).compile(
                lp, null);

        Assert.assertEquals(expectedRoots, pp.getRoots().size());

```